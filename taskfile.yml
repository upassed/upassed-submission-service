version: "3"

tasks:
    run-local:
        desc: "Run service on a local machine"
        cmds:
            - go run ./cmd/main.go --config ./config/local.yml
    test:
        desc: "Run all rests"
        cmds:
            - go clean -testcache
            - gotestsum --format-hide-empty-pkg --format-icons hivis -- -coverprofile=cover.out ./...
    mockgen:
        desc: "Generate all mocks"
        cmds:
            - rm -rf internal/util/mocks/*
            - mockgen -source=internal/repository/submission/repository.go -destination=internal/util/mocks/mock_submission_repository.go -package mocks -mock_names Repository=SubmissionRepository Repository
            - mockgen -source=internal/service/submission/service.go -destination=internal/util/mocks/mock_submission_service.go -package mocks -mock_names Service=SubmissionService Service
            - mockgen -source=internal/middleware/common/auth/auth.go -destination=internal/util/mocks/mock_auth_client_middleware.go -package mocks -mock_names Client=AuthClientMW Client
